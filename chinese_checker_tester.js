describe("In Chinese Check ", function(){
	function expectMoveOk(turnIndexBeforeMove,stateBeforeMove, move){
		expect(
			chinese_checker.isMoveOk({turnIndexBeforeMove: turnIndexBeforeMove, stateBeforeMove: stateBeforeMove, move: move})
		).toBe(true);
	}
	
	function expectIllegalMove(turnIndexBeforeMove,stateBeforeMove, move){
		expect(
			chinese_checker.isMoveOk({turnIndexBeforeMove: turnIndexBeforeMove, stateBeforeMove: stateBeforeMove, move: move})
		).toBe(false);
	}
	
	function expectLegalHistoryThatEndsTheGame(history){
		for (var i=0; i<history.length; i++){
			expectMoveOk(
				history[i].turnIndexBeforeMove,
				history[i].stateBeforeMove,
				history[i].move);
		}
		expect(history[history.length-1].move[0].endMatch).toBeDefined();
	}
	
	it("go through the example game, check every move and make sure the final winner should be player 'O' ", function(){
		var exampleResults = chinese_checker.getExampleGame();
		expectLegalHistoryThatEndsTheGame(exampleResults);
		//expect(JSON.stringify(exampleResults[exampleResults.length-1].move[0].endMatch.endMatchScores) === JSON.stringify([1,0])).toBe(true)
	});
	
	it("in case of player X win the game ", function(){
		expectMoveOk(
			 1,  {
      	board:[
		['','','','','','','','','','','','','','',''],
		['','','','','','a','','','','','','','','',''],
		['','','','','','a','a','','','','','','','',''],
		['','','','','','a','a','a','','','','','','',''],
		['','','','','','a','a','a','a','','','','','','','','',''],
		['','X','X','X','X','a','a','a','a','a','a','a','a','a',''],
		['','','X','X','X','a','a','a','a','a','a','a','a','a',''],
		['','','','X','a','X','a','a','a','a','a','a','a','a',''],
		['','','','','X','a','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a','O',''],
		['','','','','','a','a','a','a','a','a','a','a','O','O','a',''],
		['','','','','','a','a','a','a','a','a','a','a','O','O','a','O',''],
		['','','','','','a','a','a','a','a','a','a','a','a','O','O','O','O',''],
		['','','','','','','','','','','a','a','a','a','','','','','','','',''],
		['','','','','','','','','','','','a','a','a',''],
		['','','','','','','','','','','','','a','a',''],
		['','','','','','','','','','','','','','a',''],
		['','','','','','','','','','','','','','','']
		],
		delta: {oldrow: 5, oldcol: 3, row: 5, col: 5}
      }, 
         [{setTurn: {turnIndex : 0}},
          {set: {key: 'board', value: [
		['','','','','','','','','','','','','','',''],
		['','','','','','a','','','','','','','','',''],
		['','','','','','a','a','','','','','','','',''],
		['','','','','','a','a','a','','','','','','',''],
		['','','','','','a','a','a','a','','','','','','','','',''],
		['','X','X','X','X','a','a','a','a','a','a','a','a','a',''],
		['','','X','X','X','a','a','a','a','a','a','a','a','a',''],
		['','','','X','X','a','a','a','a','a','a','a','a','a',''],
		['','','','','X','a','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a','O',''],
		['','','','','','a','a','a','a','a','a','a','a','O','O','a',''],
		['','','','','','a','a','a','a','a','a','a','a','O','O','a','O',''],
		['','','','','','a','a','a','a','a','a','a','a','a','O','O','O','O',''],
		['','','','','','','','','','','a','a','a','a','','','','','','','',''],
		['','','','','','','','','','','','a','a','a',''],
		['','','','','','','','','','','','','a','a',''],
		['','','','','','','','','','','','','','a',''],
		['','','','','','','','','','','','','','','']
		]}},
          {set: {key: 'delta', value: {oldrow: 7, oldcol: 5, row: 7, col: 4}}}]
		);
	});
	
	
	
	it("an out-board move is expected to be illegal", function(){
		expectIllegalMove(
			 0, {
      	board:[
		['','','','','','','','','','','','','','',''],
		['','','','','','a','','','','','','','','',''],
		['','','','','','a','a','','','','','','','',''],
		['','','','','','a','a','a','','','','','','',''],
		['','','','','','a','a','a','a','','','','','','','','',''],
		['','O','O','a','O','O','a','a','a','a','a','a','a','a',''],
		['','','O','a','O','a','a','a','a','a','a','a','a','a',''],
		['','','','O','O','a','a','a','a','a','a','a','a','a',''],
		['','','','','O','O','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a','X',''],
		['','','','','','a','a','a','a','a','a','a','a','X','X','a',''],
		['','','','','','a','a','a','a','a','a','a','a','X','X','a','X',''],
		['','','','','','a','a','a','a','a','a','a','a','a','X','X','X','X',''],
		['','','','','','','','','','','a','a','a','a','','','','','','','',''],
		['','','','','','','','','','','','a','a','a',''],
		['','','','','','','','','','','','','a','a',''],
		['','','','','','','','','','','','','','a',''],
		['','','','','','','','','','','','','','','']
		],
		delta: {oldrow: 5, oldcol: 3, row: 5, col: 5}
      }, 
        [{setTurn: {turnIndex : 1}},
          {set: {key: 'board', value: [
		['O','','','','','','','','','','','','','',''],
		['','','','','','a','','','','','','','','',''],
		['','','','','','a','a','','','','','','','',''],
		['','','','','','a','a','a','','','','','','',''],
		['','','','','','a','a','a','a','','','','','','','','',''],
		['','a','O','a','O','O','a','a','a','a','a','a','a','a',''],
		['','','O','a','O','a','a','a','a','a','a','a','a','a',''],
		['','','','O','O','a','a','a','a','a','a','a','a','a',''],
		['','','','','O','O','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a','X',''],
		['','','','','','a','a','a','a','a','a','a','a','X','X','a',''],
		['','','','','','a','a','a','a','a','a','a','a','X','X','a','X',''],
		['','','','','','a','a','a','a','a','a','a','a','a','X','X','X','X',''],
		['','','','','','','','','','','a','a','a','a','','','','','','','',''],
		['','','','','','','','','','','','a','a','a',''],
		['','','','','','','','','','','','','a','a',''],
		['','','','','','','','','','','','','','a',''],
		['','','','','','','','','','','','','','','']
		]}},
          {set: {key: 'delta', value: {oldrow: 5, oldcol: 1, row: 0, col: 0}}}]
		);
	});
	
	
	
	it(" an illegal multiple-jumping hop should be detected successfully ", function(){
		expectIllegalMove(
			 0, {
      	board:[
		['','','','','','','','','','','','','','',''],
		['','','','','','a','','','','','','','','',''],
		['','','','','','a','a','','','','','','','',''],
		['','','','','','a','a','a','','','','','','',''],
		['','','','','','a','a','a','a','','','','','','','','',''],
		['','a','O','a','a','a','a','a','a','a','a','a','a','a',''],
		['','','a','O','O','a','a','a','a','a','a','a','a','a',''],
		['','','','O','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','a','O','a','a','a','a','X','X','a','a',''],
		['','','','','','a','a','O','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','O','a','a','O','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','O','X','O','X','X','a','X',''],
		['','','','','','a','a','a','a','a','a','X','a','a','a','X','a','X',''],
		['','','','','','','','','','','a','a','a','a','','','','','','','',''],
		['','','','','','','','','','','','a','a','a',''],
		['','','','','','','','','','','','','a','a',''],
		['','','','','','','','','','','','','','a',''],
		['','','','','','','','','','','','','','','']
		],
		delta: {oldrow: 5, oldcol: 3, row: 5, col: 5}
      }, 
        [{setTurn: {turnIndex : 1}},
          {set: {key: 'board', value: [
		['','','','','','','','','','','','','','',''],
		['','','','','','a','','','','','','','','',''],
		['','','','','','a','a','','','','','','','',''],
		['','','','','','a','a','a','','','','','','',''],
		['','','','','','a','a','a','a','','','','','','','','',''],
		['','a','a','a','a','a','a','a','a','a','a','a','a','a',''],
		['','','a','O','O','a','a','a','a','a','a','a','a','a',''],
		['','','','O','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','a','O','a','a','a','O','X','X','a','a',''],
		['','','','','','a','a','O','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','O','a','a','O','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','O','X','O','X','X','a','X',''],
		['','','','','','a','a','a','a','a','a','X','a','a','a','X','a','X',''],
		['','','','','','','','','','','a','a','a','a','','','','','','','',''],
		['','','','','','','','','','','','a','a','a',''],
		['','','','','','','','','','','','','a','a',''],
		['','','','','','','','','','','','','','a',''],
		['','','','','','','','','','','','','','','']
		]}},
          {set: {key: 'delta', value: {oldrow: 5, oldcol: 2, row: 8, col: 9}}}]
		);
	});
	
	
	it(" move a piece to a non-empty position would be consided as illegal ", function(){
		expectIllegalMove(
			 0, {
      	board:[
		['','','','','','','','','','','','','','',''],
		['','','','','','a','','','','','','','','',''],
		['','','','','','a','a','','','','','','','',''],
		['','','','','','a','a','a','','','','','','',''],
		['','','','','','a','a','a','a','','','','','','','','',''],
		['','a','O','a','a','a','a','a','a','a','a','a','a','a',''],
		['','','a','O','O','a','a','a','a','a','a','a','a','a',''],
		['','','','O','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','a','O','a','a','a','a','X','X','a','a',''],
		['','','','','','a','a','O','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','O','a','a','O','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','O','X','O','X','X','a','X',''],
		['','','','','','a','a','a','a','a','a','X','a','a','a','X','a','X',''],
		['','','','','','','','','','','a','a','a','a','','','','','','','',''],
		['','','','','','','','','','','','a','a','a',''],
		['','','','','','','','','','','','','a','a',''],
		['','','','','','','','','','','','','','a',''],
		['','','','','','','','','','','','','','','']
		],
		delta: {oldrow: 5, oldcol: 3, row: 5, col: 5}
      }, 
        [{setTurn: {turnIndex : 1}},
          {set: {key: 'board', value: [
		['','','','','','','','','','','','','','',''],
		['','','','','','a','','','','','','','','',''],
		['','','','','','a','a','','','','','','','',''],
		['','','','','','a','a','a','','','','','','',''],
		['','','','','','a','a','a','a','','','','','','','','',''],
		['','a','a','a','a','a','a','a','a','a','a','a','a','a',''],
		['','','a','O','O','a','a','a','a','a','a','a','a','a',''],
		['','','','O','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','a','O','a','a','a','a','X','X','a','a',''],
		['','','','','','a','a','O','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','O','a','a','O','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','O','X','O','X','X','a','X',''],
		['','','','','','a','a','a','a','a','a','X','a','a','a','X','a','X',''],
		['','','','','','','','','','','a','a','a','a','','','','','','','',''],
		['','','','','','','','','','','','a','a','a',''],
		['','','','','','','','','','','','','a','a',''],
		['','','','','','','','','','','','','','a',''],
		['','','','','','','','','','','','','','','']
		]}},
          {set: {key: 'delta', value: {oldrow: 5, oldcol: 2, row: 6, col: 3}}}]
		);
	});
	
	
	it(" a player try to move other's piece is illegal ", function(){
		expectIllegalMove(
			 0, {
      	board:[
		['','','','','','','','','','','','','','',''],
		['','','','','','a','','','','','','','','',''],
		['','','','','','a','a','','','','','','','',''],
		['','','','','','a','a','a','','','','','','',''],
		['','','','','','a','a','a','a','','','','','','','','',''],
		['','a','O','a','a','a','a','a','a','a','a','a','a','a',''],
		['','','a','O','O','a','a','a','a','a','a','a','a','a',''],
		['','','','O','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','a','O','a','a','a','a','X','X','a','a',''],
		['','','','','','a','a','O','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','O','a','a','O','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','O','X','O','X','X','a','X',''],
		['','','','','','a','a','a','a','a','a','X','a','a','a','X','a','X',''],
		['','','','','','','','','','','a','a','a','a','','','','','','','',''],
		['','','','','','','','','','','','a','a','a',''],
		['','','','','','','','','','','','','a','a',''],
		['','','','','','','','','','','','','','a',''],
		['','','','','','','','','','','','','','','']
		],
		delta: {oldrow: 5, oldcol: 3, row: 5, col: 5}
      }, 
        [{setTurn: {turnIndex : 1}},
          {set: {key: 'board', value: [
		['','','','','','','','','','','','','','',''],
		['','','','','','a','','','','','','','','',''],
		['','','','','','a','a','','','','','','','',''],
		['','','','','','a','a','a','','','','','','',''],
		['','','','','','a','a','a','a','','','','','','','','',''],
		['','a','O','a','a','a','a','a','a','a','a','a','a','a',''],
		['','','O','O','O','a','a','a','a','a','a','a','a','a',''],
		['','','','O','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','a','O','a','a','a','a','X','X','a','a',''],
		['','','','','','a','a','O','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','O','a','a','O','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','O','X','O','X','X','a','X',''],
		['','','','','','a','a','a','a','a','a','X','a','a','a','X','a','X',''],
		['','','','','','','','','','','a','a','a','a','','','','','','','',''],
		['','','','','','','','','','','','a','a','a',''],
		['','','','','','','','','','','','','a','a',''],
		['','','','','','','','','','','','','','a',''],
		['','','','','','','','','','','','','','','']
		]}},
          {set: {key: 'delta', value: {oldrow: 5, oldcol: 1, row: 6, col: 2}}}]
		);
	});
	
	
	
	it(" undermine the current board is illegal ", function(){
		expectIllegalMove(
			 0, {
      	board:[
		['','','','','','','','','','','','','','',''],
		['','','','','','a','','','','','','','','',''],
		['','','','','','a','a','','','','','','','',''],
		['','','','','','a','a','a','','','','','','',''],
		['','','','','','a','a','a','a','','','','','','','','',''],
		['','a','O','a','a','a','a','a','a','a','a','a','a','a',''],
		['','','a','O','O','a','a','a','a','a','a','a','a','a',''],
		['','','','O','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','a','O','a','a','a','a','X','X','a','a',''],
		['','','','','','a','a','O','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','O','a','a','O','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','O','X','O','X','X','a','X',''],
		['','','','','','a','a','a','a','a','a','X','a','a','a','X','a','X',''],
		['','','','','','','','','','','a','a','a','a','','','','','','','',''],
		['','','','','','','','','','','','a','a','a',''],
		['','','','','','','','','','','','','a','a',''],
		['','','','','','','','','','','','','','a',''],
		['','','','','','','','','','','','','','','']
		],
		delta: {oldrow: 5, oldcol: 3, row: 5, col: 5}
      }, 
        [{setTurn: {turnIndex : 1}},
          {set: {key: 'board', value: [
		['','','','','','','','','','','','','','',''],
		['','','','','','a','','','','','','','','',''],
		['','','','','','a','a','','','','','','','',''],
		['','','','','','a','a','a','','','','','','',''],
		['','','','','','a','a','a','a','','','','','','','','',''],
		['','a','a','O','a','a','a','a','a','a','a','a','a','a',''],
		['','','a','O','O','a','a','a','a','a','a','a','a','a',''],
		['','','','O','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','a','O','a','a','a','a','a','X','a','a',''],
		['','','','','','a','a','O','a','a','X','a','a','a',''],
		['','','','','','a','a','a','a','O','a','a','O','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','O','X','O','X','X','a','X',''],
		['','','','','','a','a','a','a','a','a','X','a','a','a','X','a','X',''],
		['','','','','','','','','','','a','a','a','a','','','','','','','',''],
		['','','','','','','','','','','','a','a','a',''],
		['','','','','','','','','','','','','a','a',''],
		['','','','','','','','','','','','','','a',''],
		['','','','','','','','','','','','','','','']
		]}},
          {set: {key: 'delta', value: {oldrow: 5, oldcol: 2, row: 5, col: 3}}}]
		);
	});
	
	
	
	it("check player's turn, a double move from one player is expected to be illegal", function(){
		expectIllegalMove(
			 0,  {
      	board:[
		['','','','','','','','','','','','','','',''],
		['','','','','','a','','','','','','','','',''],
		['','','','','','a','a','','','','','','','',''],
		['','','','','','a','a','a','','','','','','',''],
		['','','','','','a','a','a','a','','','','','','','','',''],
		['','O','O','a','O','O','a','a','a','a','a','a','a','a',''],
		['','','O','a','O','a','a','a','a','a','a','a','a','a',''],
		['','','','O','O','a','a','a','a','a','a','a','a','a',''],
		['','','','','O','O','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a','X',''],
		['','','','','','a','a','a','a','a','a','a','a','X','X','a',''],
		['','','','','','a','a','a','a','a','a','a','a','X','X','a','X',''],
		['','','','','','a','a','a','a','a','a','a','a','a','X','X','X','X',''],
		['','','','','','','','','','','a','a','a','a','','','','','','','',''],
		['','','','','','','','','','','','a','a','a',''],
		['','','','','','','','','','','','','a','a',''],
		['','','','','','','','','','','','','','a',''],
		['','','','','','','','','','','','','','','']
		],
		delta: {oldrow: 5, oldcol: 3, row: 5, col: 5}
      }, 
        [{setTurn: {turnIndex : 0}},
          {set: {key: 'board', value: [
		['','','','','','','','','','','','','','',''],
		['','','','','','a','','','','','','','','',''],
		['','','','','','a','a','','','','','','','',''],
		['','','','','','a','a','a','','','','','','',''],
		['','','','','','a','a','a','a','','','','','','','','',''],
		['','a','O','a','O','O','a','a','a','a','a','a','a','a',''],
		['','','O','a','O','a','a','a','a','a','a','a','a','a',''],
		['','','','O','O','a','a','a','a','a','a','a','a','a',''],
		['','','','','O','O','a','a','a','a','a','a','a','a',''],
		['','','','','','O','a','a','a','a','a','a','a','a',''],
		['','','','','','a','a','a','a','a','a','a','a','a','X',''],
		['','','','','','a','a','a','a','a','a','a','a','X','X','a',''],
		['','','','','','a','a','a','a','a','a','a','a','X','X','a','X',''],
		['','','','','','a','a','a','a','a','a','a','a','a','X','X','X','X',''],
		['','','','','','','','','','','a','a','a','a','','','','','','','',''],
		['','','','','','','','','','','','a','a','a',''],
		['','','','','','','','','','','','','a','a',''],
		['','','','','','','','','','','','','','a',''],
		['','','','','','','','','','','','','','','']
		]}},
          {set: {key: 'delta', value: {oldrow: 5, oldcol: 1, row: 9, col: 5}}}]
		);
	});
	
	
	
	
});

  
